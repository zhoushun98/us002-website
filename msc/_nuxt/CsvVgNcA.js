import{R as se,f as ae,u as te,r as oe,y as re,_ as le}from"./orVGlpMf.js";import{q as X,r as p,x as N,d as K,Z as c,a2 as T,a3 as w,$ as u,aa as Q,b as n,L as ie,a1 as U,a8 as f,aE as ue,a0 as D,ab as I,_ as M,a5 as A,a6 as P,S as ce,an as de,ac as he,a4 as fe,U as pe,j as Se}from"./Ca8kBgT7.js";import{u as me}from"./ChkTchKf.js";const ve=["id","placeholder","aria-expanded"],ge=["aria-labelledby","onKeyup"],_e={key:0,class:"lunr-status"},be=["href"],ye=["tabIndex"],W=5,xe=X({__name:"LunrSearch",props:{indexFolderPath:{},indexName:{},inSideMenu:{type:Boolean,default:!1},placeholder:{default:""},id:{default:""},tag:{default:"div"},lang:{default:"en"},enableShowMore:{type:Boolean,default:!0}},emits:["closeSideMenu","onSearchResultsChange","navigateToSearch","onSearchActive"],setup(F,{emit:q}){const d=F,m=q,b=me({setStatus:G,indexFolderPath:d.indexFolderPath,indexName:d.indexName,language:d.lang}),y=p(!1),k=p(!1),l=p([]),C=p(void 0),v=p(""),i=p(""),x=b.getResultMeta,$=p(null),S=p(null),E={fetching:"Fetching search index",loading:"Loading search index",searching:"Searching...",noresults:"No results found"},s=N(()=>l.value&&l.value.length>W&&d.enableShowMore),h=N(()=>d.id?`-${d.id}`:""),r=N(()=>v.value?!0:!!y.value),L=N(()=>r.value||k.value);K(i,e=>{if(!e){g();return}clearTimeout(C.value),C.value=setTimeout(()=>ne(e),200)}),K(r,e=>{e?Y():V(),m("onSearchResultsChange",e)}),K(L,e=>{m("onSearchActive",e)});function B(e){e.preventDefault(),d.enableShowMore&&(m("navigateToSearch",i.value),o())}function o(){g(),m("closeSideMenu")}function g(){i.value="",y.value=!1,V(),O()}function Y(){document.body.addEventListener("mousedown",H)}function V(){document.body.removeEventListener("mousedown",H)}function H(e){$.value&&!$.value.contains(e.target)&&(y.value=!1)}function O(){v.value=""}function j(){var a,t,_,R,J;if(!r.value)return;const e=(a=S.value)==null?void 0:a.querySelector(":focus");e?e.previousSibling&&e.previousSibling.focus?e.previousSibling.focus():(J=(R=e==null?void 0:e.previousSibling)==null?void 0:R.previousSibling)!=null&&J.focus&&e.previousSibling.previousSibling.focus():(_=(t=S.value)==null?void 0:t.lastChild)==null||_.focus()}function z(){var a,t,_,R;if(!r.value)return;const e=(a=S.value)==null?void 0:a.querySelector(":focus");e?e.nextSibling&&(e.nextSibling.focus?e.nextSibling.focus():(R=(_=e==null?void 0:e.nextSibling)==null?void 0:_.nextSibling)!=null&&R.focus&&e.nextSibling.nextSibling.focus()):(t=S.value)==null||t.querySelector(":first-child").focus()}function Z(){var a;const e=(a=S.value)==null?void 0:a.querySelector(":focus");e&&(e.tagName!=="A"&&e.querySelector("a").click(),o())}function ee(){y.value=!0}async function ne(e){l.value=await b.searchInIndex(e),!l.value||!l.value.length?G("noresults"):O(),ee()}function G(e){v.value=E[e]||""}return(e,a)=>(c(),T(fe(e.tag),{ref_key:"lunrRef",ref:$,class:U(["lunr-search",{"lunr-search--active":n(L),"lunr-search--side-menu":e.inSideMenu,"lunr-search--show-results":n(r)}])},{default:w(()=>[u("form",{class:"lunr-search__wrapper",onSubmit:B},[Q(u("input",{id:`lunr-search${n(h)}`,"onUpdate:modelValue":a[0]||(a[0]=t=>ie(i)?i.value=t:null),type:"text",class:U(["lunr-search__input",{"lunr-search__input--expanded":n(r)}]),placeholder:e.placeholder,"aria-label":"Search","aria-haspopup":"true","aria-expanded":n(r),autocomplete:"off",spellcheck:"false",onKeyup:[f(Z,["enter"]),f(j,["up"]),f(z,["down"])],onFocus:a[1]||(a[1]=t=>k.value=!0),onBlur:a[2]||(a[2]=t=>k.value=!1),onKeydown:f(g,["esc"])},null,42,ve),[[ue,n(i)]]),D(e.$slots,"icons",{searchText:n(i),clearResults:g})],32),Q(u("ul",{ref_key:"resultsRef",ref:S,class:U(["lunr-results",{"lunr-results--pb0":n(s)}]),tabIndex:"-1","aria-labelledby":`lunr-search${n(h)}`,onKeyup:[f(Z,["enter"]),f(I(j,["stop","prevent"]),["up"]),f(I(z,["stop","prevent"]),["down"])],onKeydown:[a[3]||(a[3]=f(I(()=>{},["stop","prevent"]),["up"])),a[4]||(a[4]=f(I(()=>{},["stop","prevent"]),["down"]))]},[n(v)?(c(),M("li",_e,A(n(v)),1)):P("",!0),(c(!0),M(ce,null,de(n(l).slice(0,W),(t,_)=>(c(),M("li",{key:`search${n(h)}-${t.ref}`,class:"lunr-result",tabIndex:100,onClick:o},[D(e.$slots,"default",{result:t,index:_,meta:n(x)(t.ref),searchText:n(i)},()=>[u("a",{href:n(x)(t.ref).url},[u("span",null,A(n(x)(t.ref).title),1)],8,be)])]))),128)),n(s)?(c(),M("li",{key:1,class:"lunr-result lunr-result--show-more",tabIndex:100+n(l).length-1,onClick:B},[D(e.$slots,"showMoreLink",{searchText:n(i)},()=>[a[5]||(a[5]=u("a",{href:"/search"},[u("span",null,"Show more search results")],-1))])],8,ye)):P("",!0)],42,ge),[[he,n(r)]])]),_:3},8,["class"]))}}),we=Object.assign(xe,{__name:"LunrSearch"}),Me=["innerHTML"],ke=["href"],$e=["innerHTML"],Le=["href"],Re=X({__name:"SearchBox.client",props:{indexName:{},id:{default:""},inSideMenu:{type:Boolean,default:!1},enableShowMore:{type:Boolean,default:!0},clientSideNavigation:{type:Boolean,default:!0},searchLink:{default:"/learn/search/"}},emits:["closeSideMenu","onSearchResultsChange","onSearchActive"],setup(F,{emit:q}){const d=p(!1),m=F,b=q,y=Se(),k=se(y.public.lunrIndexFolderPath),l=ae(m.searchLink),C=te(),v=String(C.meta.locale);function i(s){const h=`${l}?searchTerm=${s}`;m.clientSideNavigation?oe(h):location.href=h}function x(s,h){const r=new RegExp(`(${h})`,"ig");return s.replace(r,"<u>$1</u>")}function $(){b("closeSideMenu")}function S(s){b("onSearchResultsChange",s)}function E(s){d.value=s,b("onSearchActive",s)}return(s,h)=>{const r=re,L=le,B=we;return c(),T(B,{id:s.id,"index-folder-path":n(k),"index-name":s.indexName,"enable-show-more":s.enableShowMore,lang:n(v),placeholder:s.$t("components.searchBox.search"),"in-side-menu":s.inSideMenu,onOnSearchResultsChange:S,onCloseSideMenu:$,onNavigateToSearch:i,onOnSearchActive:E},{default:w(({meta:o,searchText:g})=>[s.clientSideNavigation?(c(),T(r,{key:0,class:"search-link",href:o.url},{default:w(()=>[u("span",{innerHTML:x(o.title,g)},null,8,Me)]),_:2},1032,["href"])):(c(),M("a",{key:1,class:"search-link",href:o.url},[u("span",{innerHTML:x(o.title,g)},null,8,$e)],8,ke))]),icons:w(o=>[pe(L,{name:"search",class:"lunr-search__search-icon",size:"12"}),o.searchText?(c(),T(L,{key:0,name:"close",class:"lunr-search__close-icon",onClick:o.clearResults},null,8,["onClick"])):P("",!0)]),showMoreLink:w(({searchText:o})=>[s.clientSideNavigation?(c(),T(r,{key:0,href:`${n(l)}?searchTerm=${o}`},{default:w(()=>[u("span",null,A(s.$t("components.searchBox.showMoreSearchResults")),1)]),_:2},1032,["href"])):(c(),M("a",{key:1,href:`${n(l)}?searchTerm=${o}`},[u("span",null,A(s.$t("components.searchBox.showMoreSearchResults")),1)],8,Le))]),_:1},8,["id","index-folder-path","index-name","enable-show-more","lang","placeholder","in-side-menu"])}}}),Ne=Object.assign(Re,{__name:"SearchBox"});export{Ne as _};
