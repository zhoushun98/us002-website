/*!
 * IMPORTANT NOTE:
 * 
 *   This file is licensed only for the use of Apple developers in providing MusicKit Web Services,
 *   and is subject to the Apple Media Services Terms and Conditions and the Apple Developer Program
 *   License Agreement. You may not copy, modify, re-host, or create derivative works of this file or the
 *   accompanying Documentation, or any part thereof, including any updates, without Apple's written consent.
 * 
 *   ACKNOWLEDGEMENTS:
 *   /musickit/v1/acknowledgements.txt
 */
import{r as e,e as i,h as t,H as s,c as a}from"./p-1ec6e574.js";import{H as n,g as o}from"./p-6923b857.js";import"./p-2649b6ee.js";import"./p-bb5da73d.js";import"./p-9d409825.js";import"./p-e6747c77.js";import"./p-a0c067db.js";const r={ended:"mediaEnded",error:"mediaError",pause:"mediaPause",play:"mediaPlay",playing:"mediaPlaying",volumechange:"mediaVolumeChange",fullscreenchange:"mediaFullscreenChange",webkitfullscreenchange:"mediaFullscreenChange",msfullscreenchange:"mediaFullscreenChange",enterpictureinpicture:"mediaPictureInPictureChange",leavepictureinpicture:"mediaPictureInPictureChange"},h=["","moz","webkit","ms"],d=class{constructor(t){e(this,t),this.mediaEnded=i(this,"mediaEnded",7),this.mediaError=i(this,"mediaError",7),this.mediaFullscreenChange=i(this,"mediaFullscreenChange",7),this.mediaPictureInPictureChange=i(this,"mediaPictureInPictureChange",7),this.mediaPause=i(this,"mediaPause",7),this.mediaPlay=i(this,"mediaPlay",7),this.mediaPlaying=i(this,"mediaPlaying",7),this.mediaReady=i(this,"mediaReady",7),this.mediaVolumeChange=i(this,"mediaVolumeChange",7),this.defaultMuted=!0,this.initalized=!1,this.hostFit="cover",this.loop=!1,this.muted=!0,this.backgroundColor="rgb(0,0,0)"}async onMutedDidChange(e){this.videoElement&&(this.videoElement.muted=e)}onFitChange(e){this.hostFit=-1===["cover","contain"].indexOf(e)?"cover":e}componentWillLoad(){this.defaultMuted=this.muted,this.onFitChange(this.fit),this.handleVideoEnded=this.handleVideoEnded.bind(this)}componentDidLoad(){return this.triggerVideoEvent=this.triggerVideoEvent.bind(this),this.hlsPlayback=new n(this.mediaReady,this.mediaError),Object.keys(r).forEach((e=>{this.videoElement.addEventListener(e,this.triggerVideoEvent)})),this.videoElement.addEventListener("ended",this.handleVideoEnded),this.handleVideoLoad()}disconnectedCallback(){this.hlsPlayback&&this.hlsPlayback.destroy()}handleVolumeChange(){this.muted=this.videoElement.muted}async setBackgroundVideo(e,i=[],t){void 0!==e&&(this.backgroundVideo=e,this.backgroundColor=o(this.backgroundVideo,"rgb(0,0,0)"),this.setLanguages(i),this.vpafConfig=t,await this.handleVideoLoad())}setLanguages(e){const i=e.findIndex((e=>e.startsWith("en-")));-1!==i&&e.splice(i+1,0,"en"),this.audioLanguages=e}async destroy(){this.hlsPlayback.destroy()}async goFullscreen(){const{videoElement:e}=this;if(void 0!==e){for(const i of h){const t=this.browserPrefix(i,"requestFullscreen");if("function"==typeof e[t])return e[t](),void(e.mozRequestFullScreen&&e.setAttribute("controls","true"))}if("function"==typeof e.webkitEnterFullScreen)try{e.webkitEnterFullScreen()}catch(i){}}}async mute(){this.muted=!0}async unmute(){this.muted=!1}async play(e=!1){await this.playVideo(e)}async pause(e=!1){this.pauseVideo(e)}async stop(e=!1){await this.pause(e),this.hlsPlayback.stop()}async handleVideoEnded(){const{browserPrefix:e,element:i,videoElement:t}=this;if(document.pictureInPictureElement===i||document.pictureInPictureElement===t)return document.exitPictureInPicture();for(const s of h){const t=document[e(s,"exitFullscreen")];if("function"==typeof t&&document[e(s,"fullscreenElement")]===i)return t.call(document)}}async handleVideoLoad(){this.initalized||void 0===this.videoElement||void 0===this.backgroundVideo||await this.hlsPlayback.initialize(this.videoElement,this.backgroundVideo,this.audioLanguages,this.vpafConfig)}async playVideo(e){if(this.hlsPlayback.userInitiated=e,void 0!==this.videoElement&&void 0!==this.videoElement.play&&this.videoElement.paused)try{await this.hlsPlayback.play()}catch(i){if("AbortError"!==i.name)throw i}}pauseVideo(e){this.hlsPlayback.userInitiated=e,void 0===this.videoElement||this.videoElement.paused||this.hlsPlayback.pause()}browserPrefix(e,i){return 0===e.length?i:`${e}${i.charAt(0).toUpperCase()}${i.slice(1)}`}triggerVideoEvent(e){const i=r[e.type];void 0!==i&&this[i].emit({videoEvent:e})}render(){return t(s,{class:{"background-video":!0,[this.hostFit]:!0},style:{"--joe-color":this.backgroundColor}},t("div",{class:"background-video__wrapper"},t("video",{class:"background-video__media",playsinline:!0,width:this.width,height:this.height,preload:"auto",muted:this.defaultMuted,loop:this.loop,controls:!1,ref:e=>this.videoElement=e})))}get element(){return a(this)}static get watchers(){return{muted:["onMutedDidChange"],fit:["onFitChange"]}}};d.style=':host{display:grid;grid-template:"video" 100%/100%;align-items:stretch}:host(.contain){grid-template:"video" auto "gradient" 1fr/100%}.background-video__wrapper{grid-area:video;background-color:var(--joe-color)}:host(.contain) .background-video__wrapper{background-color:transparent;-webkit-mask-image:linear-gradient(0deg, transparent, #000 8%, #000 100%);mask-image:linear-gradient(0deg, transparent, #000 8%, #000 100%)}.background-video__media{width:100%;height:100%;display:block}.background-video__media:not(:-ms-fullscreen){object-fit:cover}.background-video__media:not(:fullscreen){object-fit:cover}:host(.contain) .background-video__media{height:auto}';export{d as amp_background_video}